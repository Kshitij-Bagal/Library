import{r as o,a as j,d as x,s as B,j as s,L as w,e as A,c as C,u as L,b as y}from"./index-DeQE5H57.js";const E=({book:e})=>{const a="https://raw.githubusercontent.com/Kshitij-Bagal/Library-images/main/",c=`${a}link_to_image_.png`,[u,d]=o.useState(`${a}${encodeURIComponent(e.name)}.jpg`),[h,p]=o.useState(!1),m=j(),l=x(B).some(t=>t.id===e.id),i=()=>{h?d(c):(d(`${a}${encodeURIComponent(e.name)}.png`),p(!0))};if(!e)return s.jsx("div",{children:"Book data is missing!"});const f=async t=>{const n=t.name;if(!n){console.error("Book ID is missing:",t);return}try{await fetch(`http://localhost:8000/api/books/${n}/increment-visit`,{method:"PATCH",headers:{"Content-Type":"application/json"}}),console.log(`Visit count increased for: ${t.name}`)}catch(v){console.error("Failed to update visit count:",v)}},r=()=>{l?(m(A(e.id)),console.log("Removed from favorites:",e.name)):(m(C(e)),console.log("Added to favorites:",e.name))};return s.jsxs("div",{className:"book-card",children:[s.jsx("img",{src:u,alt:e.name||"Book Cover",className:"book-cover",onError:i}),s.jsxs("div",{className:"book-info",children:[s.jsx("h3",{children:e.name||"Untitled"}),s.jsxs("p",{children:[s.jsx("strong",{children:"Author:"})," ",e.author||"Unknown"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Genre:"})," ",e.genre||"Not specified"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Published:"})," ",e.publishDate||"N/A"]}),s.jsx(w,{to:`/Library/book/${e.name}`,onClick:()=>f(e),className:"details-btn",children:"ðŸ“– View Details"}),s.jsx("button",{className:"fav-btn",onClick:r,children:l?"Remove from Favorites":"Add to Favorites"})]})]})},S=({books:e})=>!e||e.length===0?s.jsx("p",{children:"No books available."}):s.jsx("div",{className:"book-list",children:e.map(a=>s.jsx(E,{book:a},a.id))}),N=()=>{const[e,a]=o.useState(""),[c,u]=o.useState([]),[d,h]=o.useState([]),[p,m]=o.useState([]),[g,l]=o.useState(""),{genre:i}=L(),f=y();return o.useEffect(()=>{fetch("http://localhost:8000/api/genres").then(t=>t.json()).then(t=>m(t)).catch(t=>console.error("Error fetching genres:",t)),(async()=>{try{const n=await(await fetch("http://localhost:8000/api/books")).json();Array.isArray(n)?(u(n),h(n)):console.error("API returned invalid data:",n)}catch(t){console.error("Error fetching books:",t)}})()},[]),o.useEffect(()=>{if(!Array.isArray(c))return;let r=[...c];i&&(l(i),r=r.filter(t=>t.genre.toLowerCase()===i.toLowerCase())),e.trim()!==""&&(r=r.filter(t=>t.name.toLowerCase().includes(e.toLowerCase())||t.author.toLowerCase().includes(e.toLowerCase()))),h(r)},[e,c,i]),s.jsxs("div",{children:[s.jsx("h1",{children:"Browse Books"}),s.jsxs("div",{className:"filter",children:[s.jsx("input",{type:"text",placeholder:"Search by title or author",value:e,onChange:r=>a(r.target.value)}),s.jsxs("select",{value:g,onChange:r=>{l(r.target.value),f(`/browse-books/${r.target.value}`)},children:[s.jsx("option",{value:"",children:"All Genres"}),p.map(r=>s.jsx("option",{value:r.name.toLowerCase(),children:r.name},r.name))]})]}),s.jsx(S,{books:d})]})};export{N as default};
